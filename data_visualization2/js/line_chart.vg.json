{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "ASEAN Rice Metrics",
    "anchor": "start",
    "fontSize": 40,
    "fontWeight": "bold",
    "offset": 10
  },
  "data": {
    "url": "https://raw.githubusercontent.com/amadeatheola/FIT3179/main/data_visualization2/data/asean_rice_data.csv"
  },
  "columns": 3,
  "transform": [
    {
      "fold": [
        "Yield",
        "Production",
        "Total_Rice_Consumption",
        "ExportQuantity",
        "ImportQuantity",
        "SelfSufficiencyRatio"
      ],
      "as": ["Metric", "Value"]
    },
    {
      "calculate": "datum.Metric == 'Production' ? 'Rice Production (tonnes)' : datum.Metric == 'Total_Rice_Consumption' ? 'Total Rice Consumption (tonnes)' : datum.Metric == 'Yield' ? 'Yield (kg/ha)' : datum.Metric == 'ExportQuantity' ? 'Exports (tonnes)' : datum.Metric == 'ImportQuantity' ? 'Imports (tonnes)' : 'Self-Sufficiency Ratio (%)'",
      "as": "MetricLabel"
    },
    {
      "calculate": "datum.Metric == 'ExportQuantity' ? 1 : datum.Metric == 'ImportQuantity' ? 2 : datum.Metric == 'Production' ? 3 : datum.Metric == 'SelfSufficiencyRatio' ? 4 : datum.Metric == 'Total_Rice_Consumption' ? 5 : 6",
      "as": "MetricOrder"
    },
    {
      "calculate": "datum.Metric == 'Yield' && (datum.Country == 'Vietnam' || datum.Country == 'Indonesia') ? 'yes' : datum.Metric == 'Production' && (datum.Country == 'Thailand' || datum.Country == 'Myanmar') ? 'yes' : datum.Metric == 'Total_Rice_Consumption' && (datum.Country == 'Indonesia' || datum.Country == 'Philippines') ? 'yes' : datum.Metric == 'ExportQuantity' && (datum.Country == 'Thailand' || datum.Country == 'Vietnam') ? 'yes' : datum.Metric == 'ImportQuantity' && (datum.Country == 'Philippines' || datum.Country == 'Malaysia') ? 'yes' : datum.Metric == 'SelfSufficiencyRatio' && (datum.Country == 'Laos' || datum.Country == 'Timor-Leste') ? 'yes' : 'no'",
      "as": "Highlight"
    }
  ],
  "facet": {
    "field": "MetricLabel",
  "type": "nominal",
  "sort": {"field": "MetricOrder"},
  "title": null },
  "spec": {
    "width": 460,
    "height": 400,
    "mark": {
      "type": "line",
      "point": true
    },
    "encoding": {
      "x": {
        "field": "Year",
        "timeUnit": "year",
        "axis": {
          "title": null,
          "labelAngle": 0
        }
      },
      "y": {
        "field": "Value",
        "type": "quantitative",
        "axis": {
          "title": null,
          "format": "~s"
        }
      },
      "color": {
        "field": "Country",
        "type": "nominal",
        "scale": {
              "domain": [
                "Cambodia",
                "Indonesia",
                "Laos",
                "Malaysia",
                "Myanmar",
                "Philippines",
                "Thailand",
                "Timor-Leste",
                "Vietnam",
                "World"
              ],
              "range": [
                "#2a9d8f",  
                "#e76f51",  
                "#264653",  
                "#f4a261",  
                "#e9c46a",  
                "#457b9d",  
                "#8d99ae", 
                "#d62828",  
                "#f77f00",  
                "#cccccc"   
              ]
            },
        "legend": {
          "title": "Country"
        }
      },
      "opacity": {
        "condition": {
          "test": "datum.Highlight == 'yes'",
          "value": 1
        },
        "value": 0.30
      },
      "tooltip": [
        {"field": "Country"},
        {"field": "Year"},
        {"field": "MetricLabel"},
        {"field": "Value", "format": ",.2f"}
      ]
    }
  },
  "resolve": {
    "scale": {
      "y": "independent"
    }
  }
}