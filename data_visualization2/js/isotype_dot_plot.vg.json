{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "autosize": { "type": "fit", "contains": "padding" },
  "data": {
    "url": "https://raw.githubusercontent.com/amadeatheola/FIT3179/main/data_visualization2/js/rice-consumption-portion-ASEAN.json"
  },
  "params" : [
    {
      "name": "year_selection",
      "value": 2022,
      "bind": {
        "input": "range",
        "min": 2015,
        "max": 2022,
        "step": 1,
        "name": "Year:  "
      }
    },
    {
      "name": "country_selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Cambodia",
          "Indonesia",
          "Laos",
          "Malaysia",
          "Myanmar",
          "Philippines",
          "Thailand",
          "Timor-Leste",
          "Vietnam"
        ],
        "labels": [
          "Show All",
          "Cambodia",
          "Indonesia",
          "Laos",
          "Malaysia",
          "Myanmar",
          "Philippines",
          "Thailand",
          "Timor-Leste",
          "Vietnam"
        ],
        "name": "Select Country: "
      }
    }
  ],
  "transform": [
    {
      "filter" : "datum.year == year_selection"
    },
    {
      "filter": "country_selection == null || datum.country == country_selection"
    }
  ],
  "columns": 1,
  "facet": {
    "field": "country",
    "type": "nominal",
    "header": {
      "labelFontSize": 14,
      "labelOrient": "top",
      "title": "Rice consumption portions per person per day (ASEAN, 2022)",
      "titleFontSize": 18,
      "titlePadding": 15,
      "titleOrient": "top",
      "titleAnchor": "start"
    }
  },
  "spec" : {
    "width": 600,
    "height": 40,
    "layer": [
      {
        "mark": { "type": "point", "filled": true },
        "encoding": {
          "x": { "field": "col", "type": "ordinal", "axis": null },
          "y": { "value": 0 },
          "shape": {
            "field": "food",
            "type": "nominal",
            "scale": {
              "domain": ["rice"],
              "range": [
                "M 22.2 -1.9 c -0.3 -0.2 -0.8 -0.1 -1.1 0.2 l -3.8 5.7 c -0.2 -0.2 -0.5 -0.4 -0.8 -0.5 c -0.1 -0.1 -0.1 -0.3 -0.2 -0.5 L 18.8 -2.9 c 0 -0 0 -0.1 0 -0.1 c 0.1 -0.4 -0.1 -0.8 -0.5 -0.9 c -0.4 -0.1 -0.8 0.1 -0.9 0.5 l -1.8 5.7 c -0.4 -0.3 -0.9 -0.5 -1.5 -0.5 c -0.3 0 -0.7 0.1 -1 0.2 c -0.5 -0.4 -1.2 -0.6 -1.9 -0.6 c -0.7 0 -1.4 0.2 -2 0.7 c -0.2 -0.1 -0.4 -0.1 -0.6 -0.1 c -1.2 0 -2.1 0.8 -2.4 2 c -1 0.2 -1.8 1.2 -1.8 2.2 c -0.9 0.3 -1.6 1.2 -1.6 2.2 c 0 0 0 0.1 0 0.1 H 2.5 v 0.5 C 2.5 12.2 4 15.2 6.8 17 l -0.8 2 h 11.2 L 16.4 17 C 19.1 15.2 20.7 12.2 20.7 8.9 v -0.5 h -0.8 c -0.1 -0.2 -0.2 -0.5 -0.4 -0.7 c 0.1 -0.1 0.1 -0.3 0.1 -0.5 c 0 -1.1 -0.7 -2 -1.7 -2.3 c -0.1 -0.1 -0.1 -0.1 -0.1 -0.1 l 4.6 -5.5 c 0 -0.1 0 -0.1 0.1 -0.1 C 22.6 -1.3 22.5 -1.7 22.2 -1.9 Z M 16.9 5.4 l 0.1 0.3 l 0.3 0.1 c 0.7 0.1 1.2 0.7 1.2 1.3 c 0 0.1 -0.1 0.3 -0.1 0.5 l -0.1 0.3 l 0.2 0.2 c 0.1 0.1 0.2 0.2 0.2 0.2 H 3.9 c 0 -0 0 -0.1 0 -0.1 c 0 -0.7 0.5 -1.2 1.2 -1.3 l 0.5 -0.1 l -0.1 -0.5 c 0 -0.1 0 -0.1 0 -0.2 c 0 -0.7 0.6 -1.4 1.3 -1.4 l 0.5 -0.1 l 0 -0.5 c 0 -0.1 0 -0.1 0 -0.1 c 0 -0.7 0.6 -1.3 1.3 -1.3 c 0.1 0 0.3 0 0.5 0.1 l 0.3 0.1 l 0.2 -0.2 c 0.3 -0.4 0.9 -0.6 1.5 -0.6 c 0.6 0 1.1 0.2 1.5 0.6 l 0.3 0.3 l 0.3 -0.2 c 0.2 -0.2 0.5 -0.2 0.8 -0.2 c 0.7 0 1.2 0.5 1.4 1.2 l 0.1 0.3 l 0.3 0.1 C 16.4 4.5 16.8 4.9 16.9 5.4 Z"
              ]
            },
            "legend": null
          },

          "color": { "field": "country", "type": "nominal", "legend": null },
          "size": { "value": 30 },
          "tooltip": [
          {"field": "country", "type": "nominal", "title": "Country"},
          {"field": "year", "type": "ordinal", "title": "Year"},
          {
            "field": "RiceConsumptionDaily",
            "type": "quantitative",
            "title": "Daily Rice Consumption (g/person)",
            "format": ".2f"
          },
          {
            "field": "Portion",
            "type": "quantitative",
            "title": "Portions per Person per Day",
            "format": ".0f"
          }
        ]
        }
      },
      {
        "transform": [
          {
            "calculate": "datum.Portion - 3",
            "as": "ExcessPortion"
          },
          {
            "calculate": "datum.Portion > 3 ? 'Exceeds WHO recommendation by ' + (datum.Portion - 3) + ' portions' : datum.Portion < 3 ? 'Below WHO recommendation by ' + (3 - datum.Portion) + ' portions' : 'Meets WHO recommendation'",
            "as": "WHOComparison"
          }
        ],
        "mark": {
          "type": "rule",
          "strokeDash": [4, 4],
          "color": "#e74c3c",
          "strokeWidth": 2,
          "opacity": 0.7
        },
        "encoding": {
          "x": {
            "datum": 4,
            "type": "ordinal"
          },
          "tooltip": [
            {
              "field": "WHOComparison",
              "type": "nominal",
              "title": "Country Status"
            }
          ]
        }
      }
    ]
  },
  "config": {
    "view": { "stroke": "transparent" }
  }
}